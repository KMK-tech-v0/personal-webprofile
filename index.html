<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Kaung Myat Kyaw ‚Äî Data Analyst Portfolio (Fixed)</title>

<!-- Inter font -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<!-- html2pdf for resume download -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>

<style>
  :root{
    --bg:#071024;
    --card:#0f1724;
    --muted:#9aa6b2;
    --accent-1:#38bdf8; /* cyan */
    --accent-2:#6366f1; /* indigo */
    --glass: rgba(255,255,255,0.03);
    --radius:14px;
    --glass-2: rgba(255,255,255,0.02);
  }

  /* animated accent variables (will be animated) */
  html{ --a1: var(--accent-1); --a2: var(--accent-2); }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
    background:linear-gradient(180deg,#061223 0%, #071428 100%);
    color:#e6eef6;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    overflow-x:hidden;
  }

  /* Background layers: video + overlay + optional canvases (fallback) */
  #bgCanvas, #waveCanvas, #bgVideo, #bgOverlay {
    position:fixed;
    inset:0;
    z-index:0;
    pointer-events:none;
  }
  #bgVideo { width:100%; height:100%; object-fit:cover; display:none; }
  #bgOverlay { background:linear-gradient(180deg, rgba(6,18,35,0.55), rgba(3,9,18,0.75)); }

  .container{
    position:relative;
    z-index:1;
    max-width:1200px;
    width:100%;
    margin:36px auto;
    padding:20px;
  }

  header{
    display:flex;
    gap:18px;
    align-items:center;
    justify-content:space-between;
    background:linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.006));
    padding:18px;
    border-radius:14px;
    border:1px solid rgba(255,255,255,0.03);
    backdrop-filter: blur(6px);
    box-shadow: 0 6px 30px rgba(1,6,24,0.6);
    transition:transform .22s ease, box-shadow .22s ease;
  }
  header:hover{ transform: translateY(-2px); }

  .left {
    display:flex;
    gap:18px; /* align some extra space for larger photo */
    align-items:center;
  }
  .avatar {
    width:120px;   /* slightly larger profile photo */
    height:120px;  /* slightly larger profile photo */
    border-radius:14px;
    background:linear-gradient(135deg,var(--a1),var(--a2));
    display:grid;
    place-items:center;
    overflow:hidden; /* ensure image crops nicely */
    box-shadow:0 8px 30px rgba(56,189,248,0.08), inset 0 -8px 20px rgba(0,0,0,0.2);
  }
  .avatar img{ width:100%; height:100%; object-fit:cover; display:block; border-radius:inherit; }

  h1{margin:0;font-size:1.4rem}
  p.role{margin:0;color:var(--muted);font-weight:600}
  .contacts{color:var(--muted);font-size:0.9rem;margin-top:8px}

  .actions{display:flex;gap:10px;align-items:center;}
  .btn{
    background:linear-gradient(90deg,var(--a1),var(--a2));
    color:#042033;
    padding:10px 14px;
    border-radius:10px;
    font-weight:700;
    border:none;
    cursor:pointer;
    box-shadow:0 8px 30px rgba(56,189,248,0.06);
    display:inline-flex;align-items:center;gap:8px;
  }
  .btn.secondary{
    background:transparent;
    color:var(--a1);
    border:1px solid rgba(255,255,255,0.06);
    box-shadow:none;
  }
  .btn.ghost{ background:transparent; color:var(--muted); border:none; box-shadow:none; padding:8px; }

  .grid{
    display:grid;
    grid-template-columns: 380px 1fr;
    gap:22px;
    margin-top:20px;
  }
  @media (max-width:980px){
    .grid{grid-template-columns:1fr; padding-bottom:30px}
    .left h1{font-size:1.12rem}
    .actions{ width:100%; }
  }

  .sidebar{
    background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));
    padding:18px;
    border-radius:var(--radius);
    border:1px solid rgba(255,255,255,0.03);
  }
  .block{margin-bottom:20px}
  .block h3{margin:0 0 10px 0;font-size:1.05rem;color:var(--a1)}
  .muted{color:var(--muted);font-size:0.95rem}

  /* Skills */
  .skill{margin:10px 0; opacity:0; transform:translateY(8px); transition:opacity .6s ease, transform .6s ease;}
  .skill.visible{opacity:1; transform:none;}
  .skill .meta{display:flex;justify-content:space-between;font-size:0.9rem;margin-bottom:8px}
  .bar{
    width:100%;
    height:12px;
    background:rgba(255,255,255,0.02);
    border-radius:10px;
    overflow:hidden;
  }
  .bar > i{
    display:block;height:100%;width:0;background:linear-gradient(90deg,var(--a1),var(--a2));
    transition:width 1s cubic-bezier(.2,.9,.2,1);
  }

  /* Main area */
  .main{display:flex;flex-direction:column;gap:18px;}
  .controls{display:flex;gap:10px;align-items:center;flex-wrap:wrap;}
  .filter-btn{padding:8px 12px;background:transparent;border:1px solid rgba(255,255,255,0.05);color:var(--muted);border-radius:10px;cursor:pointer;}
  .filter-btn.active{background:linear-gradient(90deg,var(--a1),var(--a2));color:#041026;border:none;}

  .projects{display:grid;grid-template-columns: repeat(auto-fit, minmax(220px,1fr));gap:16px;}
  .card{
    background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
    border-radius:12px;
    overflow:hidden;
    transition:transform .25s ease, box-shadow .25s ease, opacity .5s ease;
    border:1px solid rgba(255,255,255,0.03);
    display:flex;flex-direction:column;
    cursor:pointer;
    opacity:0; transform:translateY(8px);
  }
  .card.visible{opacity:1; transform:none;}
  .card:hover{transform:translateY(-8px);box-shadow:0 20px 60px rgba(2,6,23,0.6)}
  .card .media{background:#071428;display:block;position:relative;aspect-ratio:16/9;height:auto;}
  @supports not (aspect-ratio: 1 / 1) {
    .card .media{ position:relative; }
    .card .media::before{ content:""; display:block; padding-top:56.25%; }
    .card .media > img, .card .media > video{ position:absolute; inset:0; width:100%; height:100%; object-fit:cover; }
  }
  .card img{width:100%;height:100%;object-fit:cover;display:block;filter:blur(6px);transition:filter .6s ease, opacity .6s ease;opacity:0.98}
  .card img.loaded{filter:none; opacity:1}
  .card .body{padding:16px;flex:1;display:flex;flex-direction:column}
  .card h4{margin:0;font-size:1rem}
  .card p{margin:8px 0 10px 0;color:var(--muted);font-size:0.95rem;flex:1}
  .tags{display:flex;gap:8px;flex-wrap:wrap}
  .tag{font-size:0.8rem;padding:6px 8px;border-radius:8px;background:rgba(255,255,255,0.02);color:var(--muted)}

  .chart-box{
    background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
    padding:16px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);
    /* Fix for auto-scrolling issue */
    overflow: hidden;
  }
  .chart-box canvas{ width:100% !important; display:block; }

  .right-align{display:flex;gap:8px;align-items:center;flex-wrap:wrap;}
  .muted-block{color:var(--muted);font-size:0.9rem}

  .ai-controls{display:flex;gap:8px;margin-top:8px;flex-wrap:wrap}
  .textarea{width:100%;min-height:72px;padding:10px;background:rgba(255,255,255,0.02);border-radius:10px;border:1px solid rgba(255,255,255,0.03);color:inherit;resize:vertical}
  img, video{max-width:100%;height:auto;display:block}
  .actions .btn, .actions .filter-btn{max-width:100%;white-space:normal;min-width:0}
  .muted, .contacts{overflow-wrap:anywhere;word-break:break-word}

  footer{margin-top:26px;text-align:center;color:var(--muted);font-size:0.9rem}

  /* modal */
  .modal-backdrop{
    position:fixed;inset:0;background:linear-gradient(180deg, rgba(1,4,10,0.6), rgba(1,4,10,0.75));
    display:grid;place-items:center;z-index:40;padding:20px;
  }
  .modal-content{
    width:100%;max-width:920px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius:12px;padding:18px;border:1px solid rgba(255,255,255,0.04);box-shadow:0 24px 60px rgba(0,0,0,0.6);
    display:grid;grid-template-columns:1fr 360px;gap:16px;
  }
  .modal-left img{width:100%;height:auto;max-height:340px;object-fit:cover;border-radius:8px}
  .modal-right{display:flex;flex-direction:column;gap:8px}
  .close-x{position:absolute;right:18px;top:18px;cursor:pointer;font-size:22px;color:var(--muted)}
  @media (max-width:900px){
    .modal-content{grid-template-columns:1fr;max-height:90vh;overflow:auto}
    .modal-left img{height:220px}
  }

  /* resume progress */
  .loader{
    width:20px;height:20px;border-radius:50%;border:3px solid rgba(255,255,255,0.08);border-top-color:var(--a1);animation:spin 1s linear infinite;
  }
  @keyframes spin{to{transform:rotate(360deg)}}

  /* tiny helpers */
  .search{background:rgba(255,255,255,0.02);border-radius:10px;padding:8px 10px;border:1px solid rgba(255,255,255,0.03);display:flex;align-items:center;gap:8px}
  .search input{background:transparent;border:none;outline:none;color:inherit;font-size:0.95rem;width:100%;min-width:0}

  /* animated accent shift */
  @keyframes accentShift {
    0% { --a1: #38bdf8; --a2: #6366f1; }
    25%{ --a1: #7c3aed; --a2: #06b6d4; }
    50% { --a1: #06b6d4; --a2: #7c3aed; }
    75% { --a1: #06d6a0; --a2: #89f7fe; }
    100% { --a1: #38bdf8; --a2: #6366f1; }
  }
  html{ animation: accentShift 14s ease-in-out infinite; }

  /* small responsive tweaks for footer and mobile cards */
  @media (max-width:420px){
    .avatar{width:96px;height:96px}
    header{padding:12px}
  }

  /* Mobile-first responsive enhancements */
  .charts-grid{ display:grid; grid-template-columns:1fr 320px; gap:16px; }
  @media (max-width:980px){ .charts-grid{ grid-template-columns:1fr; } }

  @media (max-width:780px){
    .container{ margin:16px auto; padding:14px; }
    header{ flex-direction:column; align-items:stretch; gap:12px; }
    .left{ gap:12px; }
    .actions{ width:100%; flex-wrap:wrap; gap:8px; }
    .actions .btn, .actions .filter-btn{ flex:1 1 auto; }
    .search{ flex:1 1 100%; }
    .search input{ width:100%; }
    .grid{ gap:16px; }
  }
  @media (max-width:600px){
    h1{ font-size:1.2rem; }
    p.role{ font-size:0.95rem; }
    .projects{ grid-template-columns: 1fr; }
    #projectsChart{ height:220px !important; }
  }
  @media (max-width:480px){
    .avatar{ width:72px; height:72px; }
    .btn{ padding:9px 12px; }
    #dataChart{ height:260px !important; }
  }

  /* Embed-friendly overrides (e.g., Notion) */
  html.embed #bgCanvas,
  html.embed #waveCanvas,
  html.embed #bgVideo,
  html.embed #bgOverlay{ display:none !important; }
  html.embed body{ background:#061223; }
  html.embed .container{ max-width:100%; margin:0 auto; padding:12px; }
  html.embed .grid{ grid-template-columns:1fr; gap:16px; }
  html.embed .avatar{ width:96px; height:96px; }
  html.embed footer{ font-size:0.85rem }
  
  /* Fix for auto-scrolling issue */
  #projectsChart {
    max-height: 260px;
    width: 100% !important;
  }
</style>
</head>
<body>

<!-- background video -->
<canvas id="waveCanvas"></canvas>
<canvas id="bgCanvas"></canvas>
<video id="bgVideo" autoplay muted loop playsinline preload="auto">
  <source src="https://cdn.pixabay.com/video/2024/03/15/204292-923909617_tiny.mp4" type="video/mp4" />
</video>
<div id="bgOverlay"></div>

<div class="container">
  <header>
    <div class="left">
      <div class="avatar" title="Profile photo">
        <img src="assets/profile-photo.jpg" alt="Kaung Myat Kyaw profile photo"/>
      </div>
      <div>
        <h1>Kaung Myat Kyaw</h1>
        <p class="role">Data Analyst ‚Äî Telecom & Operations</p>
        <div class="contacts muted">üìç Yangon, Myanmar<br>
          üìß kaungmyatkyaw446844590@gmail.com<br>
          üìû +95 9446844590
        </div>
      </div>
    </div>

    <div class="actions">
      <div class="search" title="Search projects">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/><circle cx="11" cy="11" r="6" stroke="currentColor" stroke-width="1.6"/></svg>
        <input id="searchInput" placeholder="Search projects..." />
      </div>

      <button id="downloadResumeBtn" class="btn" title="Download resume (PDF)">üìÑ Download Resume</button>
      <button id="toggleTheme" class="btn secondary" title="Toggle accent">Toggle Accent</button>
    </div>
  </header>

  <div class="grid">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="block">
        <h3>About Me</h3>
        <p class="muted">Experienced systems architect and data analyst with 10+ years of driving operational excellence across telecom analytics, inventory workflows, and business ops. I specialize in building secure, scalable systems‚Äîmerging deep SQL expertise (SQL Server, Postgres/Supabase) with modern web stacks (Node.js, Tailwind) to deliver real-time dashboards, approval logic, and workflow automation. Known for cross-functional collaboration, I thrive in fast-paced environments where clarity, feedback, and measurable impact matter. My work transforms business needs into high-performance, compliance-ready systems that scale.</p>
        <p class="muted">Actively seeking opportunities to lead technical architecture, optimize processes, and deliver results.</p>
      </div>
      <div class="block">
        <h3>Professional Summary</h3>
        <ul class="muted" style="margin:0; padding-left:18px">
          <li>5+ years in data analytics, telecom, and operations with strong focus on dashboards, KPI tracking, and insight delivery.</li>
          <li>SQL, Python, R, Power BI; experienced in statistical analysis, data cleaning, and stakeholder communication.</li>
          <li>Cross-functional partner who leads with clarity, feedback loops, and measurable outcomes.</li>
        </ul>
      </div>

      <div class="block">
        <h3>Personal Info</h3>
        <div class="muted">
          üìç No.27, Pathein Nyunt 6st, Mingalar Taungnyunt Tsp, Yangon, Myanmar<br>
          üéÇ Date of Birth: January 6, 1998
        </div>
      </div>

      <div class="block">
        <h3>Core Competencies</h3>
        <ul class="muted">
          <li>Data Analysis & Visualization</li>
          <li>SQL & Database Management</li>
          <li>Python & R Programming</li>
          <li>Power BI & Excel Reporting</li>
          <li>Data Cleaning & Validation</li>
          <li>Statistical Modeling & Dashboards</li>
          <li>Process Optimization</li>
          <li>Cross-functional Collaboration</li>
          <li>Leadership & Training</li>
        </ul>
      </div>

      <div class="block">
        <h3>Skills</h3>
        <div id="skillsList">
          <!-- JS populates skills -->
        </div>
      </div>

      <div class="block">
        <h3>Education</h3>
        <div class="muted">
          B.A. History ‚Äî Kyaukse University, Mandalay (Jun 2018)<br>
          Business in Marketing (IQN) ‚Äî MIBA, Yangon (Nov 2018)<br>
          Business in English (IQN) ‚Äî MIBA, Yangon (Expected Nov 2024)
        </div>
      </div>

      <div class="block">
        <h3>Certifications & Training</h3>
        <ul class="muted" style="margin:0; padding-left:18px">
          <li>SOP Training ‚Äî Myanmar Nilar Food Stuff Co. Ltd</li>
          <li>ISO 22000 Training ‚Äî Nilar Frozen Foods Co. Ltd</li>
          <li>Customer Service Training ‚Äî Myanmar Nilar Food Stuff Co. Ltd</li>
          <li>Leadership & Management ‚Äî Myanmar Nilar Food Stuff Co. Ltd</li>
        </ul>
      </div>

      <div class="block">
        <h3>Hobbies</h3>
        <ul class="muted" style="margin:0; padding-left:18px">
          <li>Programming & Coding</li>
          <li>Exploring New Technologies</li>
          <li>Photography</li>
          <li>Puzzles & Logical Games</li>
        </ul>
      </div>
    </aside>

    <!-- Main -->
    <main class="main">
      <div class="chart-box">
        <div style="display:flex;justify-content:space-between;align-items:center;">
          <h3 style="margin:0;color:var(--a1)">Portfolio & Projects</h3>
          <div class="right-align">
            <div class="muted-block">Filter:</div>
            <div id="filters" class="controls"></div>
          </div>
        </div>

        <div style="margin-top:14px" id="projectsGrid" class="projects">
          <!-- JS inserts project cards -->
        </div>
      </div>

      <!-- Charts -->
      <div class="charts-grid">
        <div class="chart-box">
          <h3 style="color:var(--a1);margin-top:0">Project Metrics</h3>
          <canvas id="projectsChart" style="height:260px"></canvas>
        </div>

        <div class="chart-box">
          <h3 style="color:var(--a1);margin-top:0">Quick Actions</h3>
          <div style="margin-top:10px">
            <button id="generateSummaries" class="btn" style="width:100%;">Generate Project Summaries</button>
            <div style="margin-top:12px">
              <button id="showAllBtn" class="filter-btn" style="width:100%;">Show All Projects</button>
            </div>
            <div style="margin-top:12px">
              <label class="muted">AI Summary (template)</label>
              <textarea id="aiSummary" class="textarea" placeholder="Select a project and click Generate..."></textarea>
            </div>
          </div>
        </div>
      </div>

      <div class="chart-box">
        <h3 style="color:var(--a1)">Experience</h3>
        <div style="margin-top:8px" class="muted">
          <strong>Data Analyst</strong> ‚Äî Myanmar Padauk Engineering & Construction Co., Ltd (Mar 2024 ‚Äì Present)<br>
          <strong>Production Assistant Manager</strong> ‚Äî Nilar Frozen Foods Co., Ltd (May 2021 ‚Äì Feb 2024)<br>
          <strong>Personal Assistant</strong> ‚Äî Nilar Holding Co., Ltd (Sep 2019 ‚Äì Nov 2021)<br>
          <strong>Sales & Marketing Supervisor</strong> ‚Äî Myanmar Nilar Food Stuffs (Feb 2017 ‚Äì Aug 2019)<br>
          <strong>Interviewer (Internship)</strong> ‚Äî Neilsen MMRD (Jan 2016 ‚Äì Apr 2016)
          <strong>Warehouse Assistant</strong> ‚Äî Pro-One Home Center (Dec 2015 ‚Äì Oct 2016)<br>
          <strong>Office Executive</strong> ‚Äî ITN Company Limited (Jul 2014 ‚Äì Oct 2015)<br>
        </div>
      </div>
    </main>
  </div>

  <footer>
    Built with ‚ù§ ‚Äî "BETTER LATE THAN NEVER".
  </footer>
</div>

<!-- modal region -->
<div id="modalRoot" aria-hidden="true"></div>

<script>
// Detect Notion/embed context (iframe) or ?embed=1 flag
const IS_EMBED = (window.self !== window.top) || new URLSearchParams(location.search).get('embed') === '1';
if (IS_EMBED) document.documentElement.classList.add('embed');

/* =========================
   DATASETS ‚Äî projects expanded (8 projects) with demo CSV data
   ========================= */
const PROFILE = {
  name: "Kaung Myat Kyaw",
  title: "Data Analyst",
  contact: {
    email: "kaungmyatkyaw446844590@gmail.com",
    phone: "+95 9446844590",
    location: "Yangon, Myanmar"
  },
  skills: [
    { name: "Microsoft Excel", lvl: 95 },
    { name: "MySQL", lvl: 82 },
    { name: "Python", lvl: 72 },
    { name: "R Programming", lvl: 64 },
    { name: "Power BI", lvl: 78 },
    { name: "Data Cleaning", lvl: 98 },
    { name: "HTML", lvl: 66 },
    { name: "Microsoft PowerPoint", lvl: 86 }
  ],
  projects: [
    {
      id: "p1",
      title: "Sales Performance Dashboard",
      description: "Interactive Power BI dashboard analyzing regional sales trends with drill-down capabilities and KPI tracking.",
      tools: ["Power BI","DAX","SQL","Excel"],
      image: "assets/fc.jpg",
      metrics: { views: 1200, interactions: 320, score: 87 },
      dataset: generateDemoTimeseries("Sales", 24, 2000, 5000)
    },
    {
      id: "p2",
      title: "Customer Churn Prediction",
      description: "Logistic regression model that predicts customer churn with ~89% accuracy; includes feature importance and deployment notes.",
      tools: ["Python","Scikit-learn","Pandas"],
      image: "assets/logoelement.png",
      metrics: { views: 980, interactions: 210, score: 89 },
      dataset: generateDemoTable(["cust_id","tenure","monthly_charge","churn"], 80)
    },
    {
      id: "p3",
      title: "Network Usage Analytics",
      description: "Telecom usage analysis and anomaly detection using time-series aggregation and visualization for network ops.",
      tools: ["SQL","Python","Tableau"],
      image: "https://images.unsplash.com/photo-1519681393784-d120267933ba?q=80&w=1400&auto=format&fit=crop&crop=entropy",
      metrics: { views: 650, interactions: 120, score: 81 },
      dataset: generateDemoTimeseries("NetworkUsage", 48, 2000, 16000)
    },
    {
      id: "p4",
      title: "Inventory & Production Dashboard",
      description: "Excel + Power BI dashboards to optimize production scheduling and inventory turnover across sites.",
      tools: ["Excel","Power BI"],
      image: "https://images.unsplash.com/photo-1542744095-291d1f67b221?q=80&w=1400&auto=format&fit=crop&crop=entropy",
      metrics: { views: 400, interactions: 60, score: 74 },
      dataset: generateDemoTable(["item_id","site","stock","turnover"], 40)
    },
    {
      id: "p5",
      title: "Site Reliability Metrics",
      description: "SRE metrics dashboard with SLO tracking, incident timelines, and MTTR analysis.",
      tools: ["Grafana","PromQL","SQL"],
      image: "https://images.unsplash.com/photo-1545239351-1141bd82e8a6?q=80&w=1400&auto=format&fit=crop&crop=entropy",
      metrics: { views: 720, interactions: 98, score: 83 },
      dataset: generateDemoTimeseries("Errors", 30, 5, 120)
    },
    {
      id: "p6",
      title: "Pricing & Revenue Simulation",
      description: "Scenario-based pricing simulations using elasticity modeling and Monte Carlo sampling.",
      tools: ["Python","Pandas","MonteCarlo"],
      image: "assets/final.gif",
      metrics: { views: 510, interactions: 62, score: 77 },
      dataset: generateDemoTable(["scenario","price","revenue","prob"], 25)
    },
    {
      id: "p7",
      title: "Customer Segmentation",
      description: "K-Means clustering for customer segmentation and targeted campaign recommendations.",
      tools: ["Python","Scikit-learn","SQL"],
      image: "https://images.unsplash.com/photo-1498050108023-c5249f4df085?q=80&w=1400&auto=format&fit=crop&crop=entropy",
      metrics: { views: 430, interactions: 38, score: 76 },
      dataset: generateDemoTable(["cust_id","segment","score"], 60)
    },
    {
      id: "p8",
      title: "Operational Efficiency Tracker",
      description: "Key metrics dashboard tracking throughput, yield, and downtime with alerts and root-cause breakdowns.",
      tools: ["Excel","Power BI","SQL"],
      image: "https://images.unsplash.com/photo-1504805572947-34fad45aed93?q=80&w=1400&auto=format&fit=crop&crop=entropy",
      metrics: { views: 330, interactions: 50, score: 72 },
      dataset: generateDemoTimeseries("Throughput", 36, 100, 900)
    }
  ]
};

/* =========================
   Utility dataset generators (for demo CSV / downloads)
   ========================= */
function generateDemoTimeseries(name, points=24, min=100, max=1000){
  const out = [];
  const now = Date.now();
  for(let i=points-1;i>=0;i--){
    const ts = new Date(now - i * 3600*1000).toISOString(); // hourly points
    const value = Math.round(min + Math.random()*(max-min));
    out.push({ timestamp: ts, metric: name, value });
  }
  return out;
}
function generateDemoTable(cols, rows=20){
  const out = [];
  for(let i=0;i<rows;i++){
    const row = {};
    cols.forEach(c=>{
      if(c.includes("id")) row[c] = `ID${1000+i}`;
      else if(c.toLowerCase().includes("price") || c.toLowerCase().includes("charge")) row[c] = (Math.random()*100).toFixed(2);
      else if(c.toLowerCase().includes("score") || c.toLowerCase().includes("prob")) row[c] = Math.round(Math.random()*100);
      else if(c.toLowerCase().includes("site")) row[c] = ["A","B","C","D"][Math.floor(Math.random()*4)];
      else if(c.toLowerCase().includes("segment")) row[c] = ["HighValue","Mid","Low"][Math.floor(Math.random()*3)];
      else if(c.toLowerCase().includes("churn")) row[c] = Math.random() > 0.8 ? 1 : 0;
      else row[c] = Math.round(Math.random()*100);
    });
    out.push(row);
  }
  return out;
}

/* =========================
   Background: wave + particles
   optimized for performance
   ========================= */
const waveCanvas = document.getElementById('waveCanvas');
const bgCanvas = document.getElementById('bgCanvas');
const wctx = waveCanvas.getContext('2d');
const bctx = bgCanvas.getContext('2d');

let DPR = window.devicePixelRatio || 1;
function resizeAll(){
  DPR = window.devicePixelRatio || 1;
  for(const c of [waveCanvas, bgCanvas]){
    c.width = innerWidth * DPR;
    c.height = innerHeight * DPR;
    c.style.width = innerWidth + 'px';
    c.style.height = innerHeight + 'px';
    const ctx = c === waveCanvas ? wctx : bctx;
    ctx.setTransform(DPR,0,0,DPR,0,0);
  }
}
window.addEventListener('resize', resizeAll);
resizeAll();

// If background video is available, prefer it and stop canvas animation
const bgVideoEl = document.getElementById('bgVideo');
if (bgVideoEl) {
  const onCanPlay = () => {
    bgVideoEl.style.display = 'block';
    waveCanvas.style.display='none';
    bgCanvas.style.display='none';
    bgAnimActive = false;
    if (bgAnimFrame) cancelAnimationFrame(bgAnimFrame);
  };
  bgVideoEl.addEventListener('canplay', onCanPlay, { once:true });
  bgVideoEl.addEventListener('error', () => {
    // fallback to canvases
    bgVideoEl.style.display = 'none';
    waveCanvas.style.display='block';
    bgCanvas.style.display='block';
    if (!bgAnimActive) {
      bgAnimActive = true;
      bgAnimFrame = requestAnimationFrame(drawBackground);
    }
  }, { once:true });
}

// particles simplified
const particles = [];
const PARTICLES = IS_EMBED ? 0 : Math.max(24, Math.floor((innerWidth*innerHeight)/120000));
for(let i=0;i<PARTICLES;i++){
  particles.push({
    x: Math.random()*innerWidth,
    y: Math.random()*innerHeight,
    r: 0.6 + Math.random()*2.4,
    vx: (Math.random()-0.5)*0.4,
    vy: (Math.random()-0.5)*0.3,
    hue: 190 + Math.random()*120,
    alpha: 0.06 + Math.random()*0.16
  });
}

let wavePhase = 0;
let bgAnimActive = true;
let bgAnimFrame = null;
if (IS_EMBED) { bgAnimActive = false; }
function drawBackground(){
  if(!bgAnimActive) return;
  // wave gradient (soft)
  const g = wctx.createLinearGradient(0,0,innerWidth,innerHeight);
  g.addColorStop(0, 'rgba(6,18,35,0.7)');
  g.addColorStop(1, 'rgba(3,9,18,0.7)');
  wctx.fillStyle = g;
  wctx.fillRect(0,0,innerWidth,innerHeight);

  // waves
  wavePhase += 0.0025;
  const waveCount = 3;
  for(let k=0;k<waveCount;k++){
    const amp = 10 + k*12;
    const freq = 0.0009 + k*0.0008;
    const offsetY = innerHeight*(0.75 - k*0.06);
    wctx.beginPath();
    const grad = wctx.createLinearGradient(0,0,innerWidth,0);
    const c1 = k%2===0 ? getComputedStyle(document.documentElement).getPropertyValue('--a1').trim() : getComputedStyle(document.documentElement).getPropertyValue('--a2').trim();
    grad.addColorStop(0, hexToRgba(c1, 0.06 + k*0.02));
    grad.addColorStop(1, hexToRgba(c1, 0.01 + k*0.01));
    wctx.fillStyle = grad;
    wctx.moveTo(0, innerHeight);
    for(let x=0;x<=innerWidth;x+=24){
      const y = offsetY + Math.sin((x*freq) + wavePhase*(1+k*0.6)) * amp * Math.sin(wavePhase* (0.6+k*0.2));
      wctx.lineTo(x, y);
    }
    wctx.lineTo(innerWidth, innerHeight);
    wctx.closePath();
    wctx.fill();
  }

  // particles
  bctx.clearRect(0,0,innerWidth,innerHeight);
  for(const p of particles){
    p.x += p.vx;
    p.y += p.vy;
    if(p.x < -20) p.x = innerWidth + 20;
    if(p.x > innerWidth + 20) p.x = -20;
    if(p.y < -20) p.y = innerHeight + 20;
    if(p.y > innerHeight + 20) p.y = -20;

    bctx.beginPath();
    bctx.fillStyle = `hsla(${p.hue},80%,65%,${p.alpha})`;
    bctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
    bctx.fill();
  }

  bgAnimFrame = requestAnimationFrame(drawBackground);
}
bgAnimFrame = requestAnimationFrame(drawBackground);

function hexToRgba(hex, a){
  // handle #xxxxxx or rgb var formats (basic)
  try{
    const ctx = document.createElement('canvas').getContext('2d');
    ctx.fillStyle = hex;
    const computed = ctx.fillStyle; // "rgb(r,g,b)"
    const m = computed.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);
    if(m) return `rgba(${m[1]},${m[2]},${m[3]},${a})`;
  }catch(e){}
  return `rgba(60,160,220,${a})`;
}

/* =========================
   Render skills & animate visibility
   ========================= */
const skillsEl = document.getElementById('skillsList');
function renderSkills(){
  skillsEl.innerHTML = '';
  PROFILE.skills.forEach((s, idx)=>{
    const d = document.createElement('div');
    d.className = 'skill';
    d.innerHTML = `
      <div class="meta"><div>${escapeHtml(s.name)}</div><div>${s.lvl}%</div></div>
      <div class="bar"><i data-lvl="${s.lvl}"></i></div>
    `;
    skillsEl.appendChild(d);
  });
}
renderSkills();

// animate skill bars when visible
const skillObserver = new IntersectionObserver(entries=>{
  entries.forEach(entry=>{
    if(entry.isIntersecting){
      entry.target.querySelectorAll('i').forEach(i=>{
        const lvl = i.getAttribute('data-lvl');
        setTimeout(()=> i.style.width = (lvl)+'%', 80);
      });
      // reveal each .skill child with stagger
      Array.from(skillsEl.children).forEach((c, idx)=>{
        setTimeout(()=> c.classList.add('visible'), idx*120);
      });
      skillObserver.disconnect();
    }
  });
},{threshold:0.2});
skillObserver.observe(skillsEl);

/* =========================
   Projects render + search + filters + modal
   ========================= */
const projectsGrid = document.getElementById('projectsGrid');
const filtersEl = document.getElementById('filters');
const searchInput = document.getElementById('searchInput');
const modalRoot = document.getElementById('modalRoot');

let allTools = new Set();
PROFILE.projects.forEach(p=>p.tools.forEach(t=>allTools.add(t)));
allTools = Array.from(allTools).sort();

/* render filters */
const filterButtons = [];
function renderFilters(){
  filtersEl.innerHTML = '';
  const btnAll = document.createElement('button');
  btnAll.className = 'filter-btn active';
  btnAll.textContent = 'All';
  btnAll.dataset.tool = 'all';
  filtersEl.appendChild(btnAll);
  filterButtons.push(btnAll);
  btnAll.addEventListener('click', ()=> applyFilter('all'));

  allTools.forEach(tool=>{
    const b = document.createElement('button');
    b.className = 'filter-btn';
    b.textContent = tool;
    b.dataset.tool = tool;
    filtersEl.appendChild(b);
    filterButtons.push(b);
    b.addEventListener('click', ()=> applyFilter(tool));
  });
}
renderFilters();

function makeProjectCard(p){
  const card = document.createElement('article');
  card.className = 'card';
  card.dataset.tools = p.tools.join(',');
  card.innerHTML = `
    <div class="media">
      <img loading="lazy" alt="${escapeHtml(p.title)}" data-src="${p.image}" src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='600' height='340'><rect width='100%' height='100%' fill='%23061a2a'/></svg>" />
    </div>
    <div class="body">
      <h4>${escapeHtml(p.title)}</h4>
      <p>${escapeHtml(p.description)}</p>
      <div class="tags">${p.tools.map(t=>`<span class="tag">${t}</span>`).join('')}</div>
      <div style="display:flex;justify-content:space-between;margin-top:10px;align-items:center">
        <small class="muted">${p.metrics.score}% score ¬∑ ${p.metrics.views} views</small>
        <div style="display:flex;gap:8px">
          <button class="filter-btn btn-view" data-id="${p.id}">View</button>
          <button class="filter-btn btn-download" data-id="${p.id}">CSV</button>
        </div>
      </div>
    </div>
  `;
  // lazy load image
  // lazy load image
  const mediaDiv = card.querySelector('.media');
  const isVideo = /\.mp4($|\?)/i.test(p.image);
  if (isVideo) {
    mediaDiv.innerHTML = `<video class=\"media-video\" autoplay muted loop playsinline src=\"${p.image}\"></video>`;
  } else {
    const img = mediaDiv.querySelector('img');
    // per-project image adjustments
    if (p.id === 'p1') { img.style.objectPosition = '50% 20%'; }
    if (p.id === 'p2') { img.style.objectFit = 'contain'; }
    if (p.id === 'p6') { img.style.objectFit = 'contain'; img.style.background = '#071428'; }
    // fallback to local assets if remote fails
    img.addEventListener('error', ()=>{
      let fallback = '';
      if (p.id === 'p1') fallback = 'fc.jpg';
      else if (p.id === 'p2') fallback = 'logoelement.png';
      else if (p.id === 'p6') fallback = 'final.gif';
      if (fallback && !img.src.endsWith(fallback)) img.src = fallback;
    });
    img.addEventListener('load', ()=> img.classList.add('loaded'));
    setTimeout(()=>{ // ensure we attempt load after DOM append
      const src = img.getAttribute('data-src');
      if(src) img.src = src;
    }, 80);
  }
  // view button -> open modal
  card.querySelector('.btn-view').addEventListener('click', (e)=>{
    e.stopPropagation();
    openModal(p);
  });

  // CSV download
  card.querySelector('.btn-download').addEventListener('click', (e)=>{
    e.stopPropagation();
    downloadCsvForProject(p);
  });

  // click card -> open modal too
  card.addEventListener('click', ()=> openModal(p));

  return card;
}

function renderProjects(list = PROFILE.projects){
  projectsGrid.innerHTML = '';
  list.forEach((p, idx)=>{
    const card = makeProjectCard(p);
    projectsGrid.appendChild(card);
    // stagger reveal
    setTimeout(()=> card.classList.add('visible'), idx * 80);
  });
}
renderProjects();

/* search + filter logic */
let activeFilter = 'all';
function applyFilter(tool){
  activeFilter = tool;
  filterButtons.forEach(b=> b.classList.remove('active'));
  const match = filterButtons.find(b => b.dataset.tool === tool) || filterButtons[0];
  if(match) match.classList.add('active');
  applySearchAndFilter();
}
document.getElementById('showAllBtn').addEventListener('click', ()=> applyFilter('all'));

searchInput.addEventListener('input', ()=> applySearchAndFilter());

function applySearchAndFilter(){
  const q = (searchInput.value || '').trim().toLowerCase();
  const filtered = PROFILE.projects.filter(p=>{
    const passesFilter = activeFilter === 'all' ? true : p.tools.includes(activeFilter);
    const passesSearch = q === '' ? true :
      p.title.toLowerCase().includes(q) ||
      p.description.toLowerCase().includes(q) ||
      p.tools.join(' ').toLowerCase().includes(q);
    return passesFilter && passesSearch;
  });
  renderProjects(filtered);
}

/* modal implementation */
function openModal(project){
  modalRoot.innerHTML = '';
  modalRoot.setAttribute('aria-hidden', 'false');
  const backdrop = document.createElement('div');
  backdrop.className = 'modal-backdrop';
  backdrop.innerHTML = `
    <div class="modal-content" role="dialog" aria-modal="true" aria-label="${escapeHtml(project.title)}">
      <div style="position:relative;">
        <span class="close-x" title="Close">&times;</span>
        <div class="modal-left">
          <img src="${project.image}" alt="${escapeHtml(project.title)}"/>
        </div>
      </div>
      <div class="modal-right">
        <h2 style="margin:0">${escapeHtml(project.title)}</h2>
        <div style="color:var(--muted);margin-bottom:8px">${escapeHtml(project.tools.join(' ¬∑ '))}</div>
        <div style="flex:1;color:var(--muted);margin-bottom:8px">${escapeHtml(project.description)}</div>
        <div style="display:flex;gap:8px;">
          <button id="downloadCsvModal" class="btn">Download CSV</button>
          <button id="openChartModal" class="filter-btn">Open Data Chart</button>
          <button id="closeModalBtn" class="filter-btn">Close</button>
        </div>
        <div style="margin-top:12px">
          <small class="muted">Metrics: ${project.metrics.score}% score ¬∑ ${project.metrics.views} views ¬∑ ${project.metrics.interactions} interactions</small>
        </div>
      </div>
    </div>
  `;
  modalRoot.appendChild(backdrop);

  // per-project modal image adjustments & fallback
  const mimg = backdrop.querySelector('.modal-left img');
  if (mimg) {
    if (project.id === 'p1') { mimg.style.objectPosition = '50% 15%'; }
    if (project.id === 'p2') { mimg.style.objectFit = 'contain'; }
    if (project.id === 'p6') { mimg.style.objectFit = 'contain'; mimg.style.background = '#071428'; }
    mimg.addEventListener('error', ()=>{
      let fallback = '';
      if (project.id === 'p1') fallback = 'fc.jpg';
      else if (project.id === 'p2') fallback = 'logoelement.png';
      else if (project.id === 'p6') fallback = 'final.gif';
      if (fallback && !mimg.src.endsWith(fallback)) mimg.src = fallback;
    });
  }

  backdrop.querySelector('.close-x').addEventListener('click', closeModal);
  backdrop.querySelector('#closeModalBtn').addEventListener('click', closeModal);
  backdrop.addEventListener('click', (e)=> { if(e.target === backdrop) closeModal(); });

  backdrop.querySelector('#downloadCsvModal').addEventListener('click', ()=> downloadCsvForProject(project));
  backdrop.querySelector('#openChartModal').addEventListener('click', ()=>{
    openDataChartModal(project);
  });
}

function closeModal(){
  modalRoot.innerHTML = '';
  modalRoot.setAttribute('aria-hidden', 'true');
}

/* CSV download helper */
function downloadCsvForProject(p){
  const data = p.dataset;
  if(!data || data.length === 0){
    alert('No dataset available for this project.');
    return;
  }
  // convert to CSV
  const keys = Array.from(new Set(data.flatMap(d => Object.keys(d))));
  const rows = data.map(r => keys.map(k => JSON.stringify((r[k] !== undefined) ? r[k] : '')).join(','));
  const csv = keys.join(',') + '\n' + rows.join('\n');
  const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `${p.id}_dataset.csv`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

/* small chart modal for dataset */
function openDataChartModal(project){
  // build a new modal with a canvas and simple chart
  modalRoot.innerHTML = '';
  modalRoot.setAttribute('aria-hidden', 'false');
  const backdrop = document.createElement('div');
  backdrop.className = 'modal-backdrop';
  backdrop.innerHTML = `
    <div class="modal-content" role="dialog" aria-modal="true">
      <div style="position:relative; grid-column:1/-1;">
        <span class="close-x" title="Close">&times;</span>
        <h2 style="margin:6px 0 10px 0">${escapeHtml(project.title)} ‚Äî Data Chart</h2>
        <canvas id="dataChart" style="width:100%;height:360px;border-radius:8px;background:transparent;"></canvas>
      </div>
    </div>
  `;
  modalRoot.appendChild(backdrop);
  backdrop.querySelector('.close-x').addEventListener('click', closeModal);
  backdrop.addEventListener('click', (e)=> { if(e.target === backdrop) closeModal(); });

  // prepare chart data fallback
  const ds = project.dataset || [];
  const labels = ds.map((d,i)=> (d.timestamp ? new Date(d.timestamp).toLocaleString() : `r${i+1}`)).slice(0,40);
  const values = ds.map(d => Number(d.value ?? Object.values(d).find(v=>typeof v === 'number') ?? 0)).slice(0,40);

  // small delay to ensure canvas is in DOM
  setTimeout(()=>{
    const ctx = document.getElementById('dataChart').getContext('2d');
    new Chart(ctx, {
      type: 'line',
      data: { labels, datasets: [{ label: project.title, data: values, borderColor: getComputedStyle(document.documentElement).getPropertyValue('--a1').trim(), backgroundColor: 'rgba(255,255,255,0.03)', tension:0.25, pointRadius:2 }] },
      options: { responsive:true, plugins:{ legend:{ display:false } }, scales:{ x:{ ticks:{ color:'#9fb8c9' } }, y:{ ticks:{ color:'#9fb8c9' } } } }
    });
  }, 80);
}

/* =========================
   Projects Chart (overview)
   ========================= */
const projectsChartCtx = document.getElementById('projectsChart').getContext('2d');
let projectsChart;
function buildProjectChart(){
  const labels = PROFILE.projects.map(p=>p.title);
  const scores = PROFILE.projects.map(p=>p.metrics.score);
  const views = PROFILE.projects.map(p=>p.metrics.views);
  if(projectsChart) projectsChart.destroy();
  projectsChart = new Chart(projectsChartCtx, {
    type: 'bar',
    data:{
      labels,
      datasets:[
        { label:'Score (%)', data:scores, backgroundColor: getComputedStyle(document.documentElement).getPropertyValue('--a1').trim(), borderRadius:6, maxBarThickness:40 },
        { label:'Views', data:views, backgroundColor: getComputedStyle(document.documentElement).getPropertyValue('--a2').trim(), borderRadius:6, maxBarThickness:40 }
      ]
    },
    options:{
      responsive:true,
      maintainAspectRatio:false,
      plugins:{ legend:{ labels:{ color:'#cfeefc' } } },
      scales:{
        x:{ ticks:{ color:'#9fb8c9' }, grid:{ display:false } },
        y:{ ticks:{ color:'#9fb8c9' }, grid:{ color:'rgba(255,255,255,0.03)' } }
      }
    }
  });
}
buildProjectChart();

/* =========================
   AI-style summary generator (template)
   ========================= */
function generateSummary(project){
  const tools = project.tools.join(', ');
  const short = project.description.length > 140 ? project.description.slice(0,137) + '...' : project.description;
  return `Project "${project.title}" ‚Äî ${short} Tools: ${tools}. Outcome: mock score ${project.metrics.score}%. Dataset rows: ${project.dataset ? project.dataset.length : 0}. Focus: data cleaning, visualization, and stakeholder-facing insights.`;
}
document.getElementById('generateSummaries').addEventListener('click', ()=>{
  document.getElementById('aiSummary').value = PROFILE.projects.map(p=>generateSummary(p)).join("\n\n");
});

/* generate summary when view clicked also */
function makeSummaryForId(id){
  const p = PROFILE.projects.find(x=>x.id === id);
  if(!p) return '';
  return generateSummary(p);
}

/* =========================
   Download resume (html2pdf) with small animation
   ========================= */
const downloadBtn = document.getElementById('downloadResumeBtn');
downloadBtn.addEventListener('click', async ()=>{
  const orig = downloadBtn.innerHTML;
  // show loader
  downloadBtn.innerHTML = `<span class="loader" aria-hidden="true"></span> Generating...`;
  downloadBtn.disabled = true;

  // create a simplified export node
  const opt = {
    margin: [0.2,0.2,0.2,0.2],
    filename: `${PROFILE.name.replace(/\s+/g,'_')}_Resume.pdf`,
    image: { type: 'jpeg', quality: 0.95 },
    html2canvas: { scale: 2, logging:false, useCORS:true },
    jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
  };
  const exportNode = document.createElement('div');
  exportNode.style.background = '#061223';
  exportNode.style.color = '#e6eef6';
  exportNode.style.padding = '20px';
  exportNode.style.width = '800px';
  exportNode.style.fontFamily = 'Inter, Arial';
  exportNode.innerHTML = `
    <h1 style="margin:0">${PROFILE.name}</h1>
    <p style="margin:0.4rem 0 1rem 0;color:#9fb8c9">${PROFILE.title} ¬∑ ${PROFILE.contact.location}</p>
    <h3 style="margin-top:10px;color:#7be2ff">Summary</h3>
    <p style="color:#cfeefc">Detail-oriented and results-driven Data Analyst with experience across telecom analytics and operations. Skilled in SQL, Python, R, Power BI, Excel, and dashboard development.</p>
    <h3 style="margin-top:8px;color:#7be2ff">Skills</h3>
    <ul>${PROFILE.skills.map(s=>`<li>${s.name} ‚Äî ${s.lvl}%</li>`).join('')}</ul>
    <h3 style="margin-top:8px;color:#7be2ff">Projects</h3>
    ${PROFILE.projects.map(p=>`<div style="margin-bottom:8px"><strong>${p.title}</strong><div style="color:#9fb8c9">${p.description}</div></div>`).join('')}
    <h3 style="margin-top:8px;color:#7be2ff">Experience</h3>
    <div style="color:#cfeefc">Data Analyst ‚Äî Myanmar Padauk Engineering & Construction Co., Ltd (Mar 2024 ‚Äì Present)</div>
  `;
  document.body.appendChild(exportNode);
  try{
    await html2pdf().from(exportNode).set(opt).save();
  }catch(err){
    console.error(err);
    alert('PDF export failed in this browser ‚Äî try in Chrome/Edge.');
  }finally{
    document.body.removeChild(exportNode);
    downloadBtn.innerHTML = orig;
    downloadBtn.disabled = false;
  }
});

/* =========================
   Accent toggle (minor) - cycles three styles
   ========================= */
const toggleBtn = document.getElementById('toggleTheme');
let accentState = 0;
toggleBtn.addEventListener('click', ()=>{
  accentState = (accentState + 1) % 3;
  if(accentState === 0){
    document.documentElement.style.setProperty('--a1','#38bdf8');
    document.documentElement.style.setProperty('--a2','#6366f1');
  } else if(accentState === 1){
    document.documentElement.style.setProperty('--a1','#7c3aed');
    document.documentElement.style.setProperty('--a2','#06b6d4');
  } else {
    document.documentElement.style.setProperty('--a1','#06d6a0');
    document.documentElement.style.setProperty('--a2','#89f7fe');
  }
  // rebuild chart to pick up CSS var change color
  setTimeout(buildProjectChart, 150);
});

/* =========================
   Keyboard shortcuts
   g => generate summaries
   f => focus search
   ========================= */
document.addEventListener('keydown', e=>{
  if(e.key === 'g') document.getElementById('generateSummaries').click();
  if(e.key === 'f') { searchInput.focus(); searchInput.select(); }
});

/* =========================
   Small accessibility + performance tweaks
   Pause background on hidden
   ========================= */
document.addEventListener('visibilitychange', ()=>{
  if(document.hidden){
    // pause wave loop by using lower framerate - simple approach: reduce particle velocities
    particles.forEach(p=> { p.vx *= 0.2; p.vy *= 0.2; });
  }else{
    particles.forEach(p=> { p.vx = (Math.random()-0.5)*0.4; p.vy = (Math.random()-0.5)*0.3; });
  }
});

/* =========================
   Helper functions
   ========================= */
function escapeHtml(str){
  return String(str)
    .replace(/&/g,'&amp;')
    .replace(/</g,'&lt;')
    .replace(/>/g,'&gt;')
    .replace(/"/g,'&quot;')
    .replace(/'/g,'&#39;');
}

/* =========================
   Initial small UI effects to show content nicely
   ========================= */
setTimeout(()=> {
  document.querySelectorAll('.card').forEach((c, i)=> setTimeout(()=> c.classList.add('visible'), i*70));
}, 200);

/* Done! ‚Äî All functionality present client-side.
   If anything misbehaves in your environment, open DevTools console for quick debugging.
*/
</script>
</body>
</html>
